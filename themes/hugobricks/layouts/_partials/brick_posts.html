
{{- $inner := . -}}
{{- if or (eq $inner "") (eq $inner nil) -}}
    {{- with page.Site.GetPage "bricks/posts.md" -}}
        {{- $inner = .RawContent -}}
    {{- end -}}
{{- end -}}
{{- $posts := where page.Site.RegularPages "Section" "posts" -}}
<section class="posts">
    {{ if $inner }}<div class="container">
        <div class ="box postTitle">
            {{- markdownify $inner -}}
        </div>
    </div>{{ end }}
    <div class="container">
        <div class ="box">
            <ul class="contentitems grid posts" data-pagesize="{{ page.Site.Data.settings.page_size }}">
                {{ range $index,$post := $posts }}
                    <li class="item{{ range .Params.tags }} tag_{{ . }}{{ end }}">
                            {{- if (resources.GetMatch .Params.image) -}}
                                {{- $postimage := ((resources.GetMatch .Params.image).Fill `1200x600 jpg Smart q50`).RelPermalink -}}
                                {{- if $postimage -}}
                                    {{ if .Params.link }}
                                        <a href="{{ .Params.link }}"><div class="img"><img data-src="{{ $postimage }}" alt="{{ .Title }}" style="cursor: pointer;" onclick="document.location.href='{{ .Params.link }}';" /></div></a>
                                    {{ else }}
                                        <a href="{{ .RelPermalink }}"><div class="img"><img data-src="{{ $postimage }}" alt="{{ .Title }}" style="cursor: pointer;" onclick="document.location.href='{{ .RelPermalink }}';" /></div></a>
                                    {{ end }}
                                {{- end -}}
                            {{- end -}}
                            <h3>{{ .Title | safeHTML }}</h3>
                            {{ if .Params.date }}<div class="meta">
                                <div>
                                    <img src="/img/icons/material-symbols/200/rounded/calendar_month-fill.svg"class="black_2_textDark" alt="" />
                                    {{ .Date | time.Format ":date_medium"}}
                                </div>
                            </div>
                            {{ end }}
                            <div class="summary">
                                <p>{{ substr (.Summary | plainify) 0 190 | safeHTML }}...</p>
                                {{ if .Params.link }}
                                    <p><a href="{{ .Params.link }}" class="button ghost smaller">{{ i18n "Read more" }}</a></p>
                                {{ else }}
                                    <p><a href="{{ .RelPermalink }}" class="button ghost smaller">{{ i18n "Read more" }}</a></p>
                                {{ end}}
                            </div>
                    </li>
                {{ end }}
                <li class="placeholder"></li>
                <li class="placeholder"></li>
            </ul>
            <a class="button secondary ghost smaller" id="loadmoreposts" onclick="loadMorePosts();">{{ i18n "Load more posts" }}...</a>
            <script src="/js/filter.js" charset="utf-8"></script>
        </div>
    </div>
</section>


